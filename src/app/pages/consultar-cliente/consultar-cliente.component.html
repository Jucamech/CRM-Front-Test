<div class="nav" style="width: 100%; height: 100%;">

  <div class="nav__" style="width: 100%; height: 88px;" *ngIf="!ocultarNav">
    <app-header></app-header>
  </div>

  <div class="container" *ngIf="opcion == 0">

    <div class="row">
      <div class="form-group d-flex mt-3">
        <div class="radiobnt d-flex mt-2">
          <label>
            <input type="radio" class="mt-w" name="selectFilt" [(ngModel)]="selectFilt" value="nombres"> Nombres
          </label>
          <label>
            <input type="radio" class="mt-w ml-3" name="selectFilt" [(ngModel)]="selectFilt" value="apellidos"> Apellidos
          </label>
          <label>
            <input type="radio" class="mt-w ml-3" name="selectFilt" [(ngModel)]="selectFilt" value="telefono"> Telefono
          </label>
          <label>
            <input type="radio" class="mt-w ml-3" name="selectFilt" [(ngModel)]="selectFilt" value="id"> Id
          </label>

        </div>


        <input type="search" name="buscar" placeholder="Buscar" [(ngModel)]="inp" #filtro class="form-control ml-3"
          (keyup)="filtar($event)" />
      </div>

      <div class="mt-3 ml-4">
        <button class="btn btn-success" style="border-color: black" (click)="getAllPersonal()">
          Mis Clientes
        </button>
      </div>

      <div class="dropdown mt-3 ml-4">
        <button class="btn btn-secondary dropdown-toggle" type="button" (click)="none = !none" >
          Filtrar Status Cliente
        </button>
        <ul class="drod_mod" [class.none]="none" >
          <li><a class="dropdown-item" [class.act]="cli_act" (click)="filtrar2(1)">Cliente Activo</a></li>
          <li><a class="dropdown-item" [class.act]="inact  " (click)="filtrar2(2)">Inactivo</a></li>
          <li><a class="dropdown-item" [class.act]="rojo   " (click)="filtrar2(3)">Rojo</a></li>
          <li><a class="dropdown-item" [class.act]="virgen " (click)="filtrar2(4)">Virgen</a></li>
          <li><a class="dropdown-item" [class.act]="prosp  " (click)="filtrar2(5)">Prospecto</a></li>
          <li><a class="dropdown-item" [class.act]="prosp_h" (click)="filtrar2(6)">Prosp Ya Hablado</a></li>
          <li><a class="dropdown-item" [class.act]="prosp_n" (click)="filtrar2(7)">Prosp Negativo</a></li>
          <li><a class="dropdown-item" [class.act]="venta  " (click)="filtrar2(8)">Venta</a></li>
          <li><a class="dropdown-item" [class.act]="perdida" (click)="filtrar2(9)">Perdida</a></li>
          <li><a class="dropdown-item" [class.act]="termino" (click)="filtrar2(10)">Terminó Proceso</a></li>
        </ul>
      </div>

      <div class="mt-3 ml-4">
        <button *ngIf="toogle" class="btn btn-warning" style="border-color: black" (click)="getAll()">
          Listar Todos
        </button>
      </div>


    </div>
    <div class="row" *ngIf="id_admin">
      <div class="form-group d-flex mt-3">

        <input type="number" name="buscarID" placeholder="Buscar Telefono" [(ngModel)]="tel" #filtro2 class="form-control ml-3" />
      </div>

      <div class="mt-3 ml-4">
        <button class="btn btn-success" style="border-color: black" (click)="getCliTel()">
          Buscar Número
        </button>
      </div>

      <div class="mt-3 ml-4">
        <span *ngFor="let item of respID">
          ID: <b>{{ item.id }}</b>
          Nombre: <b>{{ item.nombres }}</b>
          <br>
        </span>
      </div>


    </div>
  </div>

  <div class="sub-filt d-flex justify-content-around">
    <span>
      <span class="link" (click)="ord = 'id' " > Ordenar por ID
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="green" class="bi bi-list-ol" viewBox="0 0 16 16" >
        <path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5z"/>
        <path d="M1.713 11.865v-.474H2c.217 0 .363-.137.363-.317 0-.185-.158-.31-.361-.31-.223 0-.367.152-.373.31h-.59c.016-.467.373-.787.986-.787.588-.002.954.291.957.703a.595.595 0 0 1-.492.594v.033a.615.615 0 0 1 .569.631c.003.533-.502.8-1.051.8-.656 0-1-.37-1.008-.794h.582c.008.178.186.306.422.309.254 0 .424-.145.422-.35-.002-.195-.155-.348-.414-.348h-.3zm-.004-4.699h-.604v-.035c0-.408.295-.844.958-.844.583 0 .96.326.96.756 0 .389-.257.617-.476.848l-.537.572v.03h1.054V9H1.143v-.395l.957-.99c.138-.142.293-.304.293-.508 0-.18-.147-.32-.342-.32a.33.33 0 0 0-.342.338v.041zM2.564 5h-.635V2.924h-.031l-.598.42v-.567l.629-.443h.635V5z"/></svg>
      </span>
      <span class="ml-3 link" (click)="ord = 'alf' " >Orden Alfa
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="green" class="bi bi-list-ul" viewBox="0 0 16 16" >
          <path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
        </svg>
      </span>
    </span>

    <span *ngIf="modocampa || campV2.length > 0 " style="font-size: x-large;color: green;">
      <b >Modo Campaña Activado</b>
    </span>

    <div class="d_flex">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="green" class="bi bi-arrow-left-circle-fill" viewBox="0 0 16 16" (click)="prevP()">
        <path d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm3.5 7.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"/>
      </svg>

      <span class="">
        {{page + 1 }} a {{page + 100 }}
      </span>

      <span *ngIf="(listClientes | consultarCli:page).length  === 100">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="green" class="bi bi-arrow-right-circle-fill" viewBox="0 0 16 16" (click)="nextP()">
          <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/>
        </svg>
      </span>
    </div>

    <span class="float-right">Total Clientes: <b>{{ total }}</b></span>
  </div>

  <div class="container_mod" #content_t>
    <table class="table table-hover table-striped table-dark" *ngIf="opcion == 0">
      <thead>
        <tr>
          <th scope="col">ID</th>
          <th scope="col">Cliente</th>
          <th scope="col">Status</th>
          <th scope="col">Fecha Inicio</th>
          <th scope="col">Celular</th>
          <th scope="col">Trabajo</th>
          <th scope="col">Fijo</th>
          <th scope="col">Otro</th>
          <th scope="col" *ngIf="modocampa || campV2.length > 0">Campaña</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of listClientes | consultarCli:page:ord">
          <th scope="row">{{ item.id }}</th>
          <td (click)="setId(item.id)">{{ item.nombres }}&nbsp;{{ item.apellidos }}</td>
          <td (click)="setId(item.id)">
            <span *ngFor="let s of statusC" >
              <span *ngIf="item.status == s[1] || item.status == s[2] ">{{ s[0] }}</span>
            </span>
          </td>
          <td (click)="setId(item.id)">{{ item.fecha_inicio }}</td>
          <td (click)="setId(item.id)">{{ item.telmovil }}</td>
          <td (click)="setId(item.id)">{{ item.teltrabajo }}</td>
          <td (click)="setId(item.id)">{{ item.telcasa }}</td>
          <td>{{ item.telotro }}</td>
          <td *ngIf="modocampa || campV2.length > 0"  class="d-flex justify-content-center">
            <span class="" *ngIf="item.status != '1' ">
              <span *ngIf="item.status != 'Client' ">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="green" class="bi bi-arrow-up-right-square-fill d-flex m-auto" viewBox="0 0 16 16" (click)="enviarCampana(item)">
                  <path d="M14 0a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12zM5.904 10.803 10 6.707v2.768a.5.5 0 0 0 1 0V5.5a.5.5 0 0 0-.5-.5H6.525a.5.5 0 1 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 .707.707z"/>
                </svg>
              </span>
            </span>
            <span *ngIf="item.actualizacion && split(item.actualizacion)[2] == 'campagne' " [title]="split(item.actualizacion)[0] | slice:0:10">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="red" class="bi bi-flag-fill mb-2 ml-1" viewBox="0 0 16 16">
                <path d="M14.778.085A.5.5 0 0 1 15 .5V8a.5.5 0 0 1-.314.464L14.5 8l.186.464-.003.001-.006.003-.023.009a12.435 12.435 0 0 1-.397.15c-.264.095-.631.223-1.047.35-.816.252-1.879.523-2.71.523-.847 0-1.548-.28-2.158-.525l-.028-.01C7.68 8.71 7.14 8.5 6.5 8.5c-.7 0-1.638.23-2.437.477A19.626 19.626 0 0 0 3 9.342V15.5a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 1 0v.282c.226-.079.496-.17.79-.26C4.606.272 5.67 0 6.5 0c.84 0 1.524.277 2.121.519l.043.018C9.286.788 9.828 1 10.5 1c.7 0 1.638-.23 2.437-.477a19.587 19.587 0 0 0 1.349-.476l.019-.007.004-.002h.001"/>
              </svg>
            </span>

            <span *ngIf="item.campagna " [title]="item.campagna">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="red" class="bi bi-flag-fill mb-2 ml-1" viewBox="0 0 16 16">
                <path d="M14.778.085A.5.5 0 0 1 15 .5V8a.5.5 0 0 1-.314.464L14.5 8l.186.464-.003.001-.006.003-.023.009a12.435 12.435 0 0 1-.397.15c-.264.095-.631.223-1.047.35-.816.252-1.879.523-2.71.523-.847 0-1.548-.28-2.158-.525l-.028-.01C7.68 8.71 7.14 8.5 6.5 8.5c-.7 0-1.638.23-2.437.477A19.626 19.626 0 0 0 3 9.342V15.5a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 1 0v.282c.226-.079.496-.17.79-.26C4.606.272 5.67 0 6.5 0c.84 0 1.524.277 2.121.519l.043.018C9.286.788 9.828 1 10.5 1c.7 0 1.638-.23 2.437-.477a19.587 19.587 0 0 0 1.349-.476l.019-.007.004-.002h.001"/>
              </svg>
            </span>

            <span *ngIf="is_admin">
              <span *ngIf="item.actualizacion && split(item.actualizacion)[2] == 'campagne' ">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="yellow" class="bi bi-trash2-fill" viewBox="0 0 16 16" (click)="resetCampa(item.id, item)">
                  <path d="M2.037 3.225A.703.703 0 0 1 2 3c0-1.105 2.686-2 6-2s6 .895 6 2a.702.702 0 0 1-.037.225l-1.684 10.104A2 2 0 0 1 10.305 15H5.694a2 2 0 0 1-1.973-1.671L2.037 3.225zm9.89-.69C10.966 2.214 9.578 2 8 2c-1.58 0-2.968.215-3.926.534-.477.16-.795.327-.975.466.18.14.498.307.975.466C5.032 3.786 6.42 4 8 4s2.967-.215 3.926-.534c.477-.16.795-.327.975-.466-.18-.14-.498-.307-.975-.466z"/>
                </svg>
              </span>
            </span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="bg" *ngIf="modal">

    <div class="">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Enviar a Campaña</h5>
            <button type="button" class="close" (click)="cerrarModal()">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>

          <div class="modal-body" >
            <h4 class="text-center mb-3">
              <span>{{itemCampa.nombres || 'LLamada'}}</span> &nbsp;
              <span *ngIf="itemCampa.apellidos">{{itemCampa.apellidos }} &nbsp;</span>
              <span *ngIf="!itemCampa.nombres && !itemCampa.apellidos">Perdida &nbsp;</span>
              - ID : {{ itemCampa.id }}
            </h4>
            <div class="row">

              <div class="form-group col-md-6" *ngIf="campanas">
                <label for="roboidentidad" class="font-w">Campaña : </label>
                <select name="campana" id="statusSel" class="form-control" [(ngModel)]="nameCamp">
                  <option *ngFor="let s of campanas" [value]="s.data.name" >{{ s.data.name }}</option>
                </select>
              </div>

              <div class="form-group col-md-6" *ngIf="campV2">
                <label for="roboidentidad" class="font-w">Campaña V2: </label>
                <select name="campanaV2" id="statusSel2" class="form-control" [(ngModel)]="dataCampV2">
                  <option *ngFor="let r of campV2" [value]="r.id" >{{ r.name }}</option>
                </select>
              </div>


            </div>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" (click)="cerrarModal()">Close</button>
            <button type="button" class="btn btn-primary" (click)="enviarCampana2()" *ngIf="nameCamp">Confirmar</button>
            <button type="button" class="btn btn-primary" (click)="enviarCampanaV2()" *ngIf="dataCampV2">Confirmar V2</button>
          </div>

        </div>
      </div>
    </div>


  </div>

  <div class="spin" *ngIf="spinner">
    <app-spinner></app-spinner>
  </div>
</div>

<app-alertas></app-alertas>


